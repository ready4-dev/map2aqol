<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="youthu">
<title>Economic analysis • youthu</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Economic analysis">
<meta property="og:description" content="youthu">
<meta property="og:image" content="https://ready4-dev.github.io/youthu/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">youthu</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Unreleased version">0.0.0.9112</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/youthu.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/Economic_Analysis.html">Economic analysis</a>
    <a class="dropdown-item" href="../articles/Prediction_With_Mdls.html">Predict Quality Adjusted Life Years (QALYs)</a>
    <a class="dropdown-item" href="../articles/V_01.html">Significant Changes To The Youthu Package</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/ready4-dev/youthu/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">



<script src="Economic_Analysis_files/accessible-code-block-0.0.1/empty-anchor.js"></script><script src="Economic_Analysis_files/kePrint-0.0.1/kePrint.js"></script><link href="Economic_Analysis_files/lightable-0.0.1/lightable.css" rel="stylesheet">
<div class="row">
  <main id="main"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Economic analysis</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/ready4-dev/youthu/blob/HEAD/vignettes/Economic_Analysis.Rmd" class="external-link"><code>vignettes/Economic_Analysis.Rmd</code></a></small>
      <div class="d-none name"><code>Economic_Analysis.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ready4-dev.github.io/youthu/">youthu</a></span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span></code></pre></div>
<p>This vignette illustrates the rationale for and practical decision-making utility of youthu’s <a href="Prediction_With_Mdls.html">QALYs prediction workflow</a>. Note, this example is illustrated with fake data and should not be used to inform decision-making.</p>
<div class="section level2">
<h2 id="motivation">Motivation<a class="anchor" aria-label="anchor" href="#motivation"></a>
</h2>
<p>The main motivation behind the youthu package is to extend the types of economic analysis that can be undertaken with both single group (e.g. pilot study, health service records) and matched groups (e.g. trial) longitudinal datasets that do not include measures of health utility. This article focuses on its application to matched group datasets.</p>
</div>
<div class="section level2">
<h2 id="example-dataset">Example dataset<a class="anchor" aria-label="anchor" href="#example-dataset"></a>
</h2>
<p>First, we must first import our data. In this example we will use a fake dataset.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ds_tb</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/make_fake_ds_two.html">make_fake_ds_two</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Joining, by = c("fkClientID", "study_arm_chr")</span></code></pre>
<p>Our dataset includes 268 matched comparisons, with each comparison containing baseline and follow-up records for one intervention arm participant and one control arm participant. The first few records are as follows.</p>
<table class="table  lightable-paper lightable-hover" style='font-family: "Arial Narrow", arial, helvetica, sans-serif; width: auto !important; margin-left: auto; margin-right: auto;border-bottom: 0;'>
<caption>
First few records from input dataset
</caption>
<thead><tr>
<th style="text-align:left;">
fkClientID
</th>
<th style="text-align:right;">
round
</th>
<th style="text-align:right;">
date_psx
</th>
<th style="text-align:right;">
duration_prd
</th>
<th style="text-align:right;">
PHQ9
</th>
<th style="text-align:right;">
SOFAS
</th>
<th style="text-align:left;">
costs_dbl
</th>
<th style="text-align:right;">
study_arm_chr
</th>
<th style="text-align:right;">
match_idx_int
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
Participant_20
</td>
<td style="text-align:right;">
Baseline
</td>
<td style="text-align:right;">
2021-07-21
</td>
<td style="text-align:right;">
0S
</td>
<td style="text-align:right;">
16
</td>
<td style="text-align:right;">
41
</td>
<td style="text-align:left;">
301.1868
</td>
<td style="text-align:right;">
Intervention
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
Participant_593
</td>
<td style="text-align:right;">
Baseline
</td>
<td style="text-align:right;">
2021-05-28
</td>
<td style="text-align:right;">
0S
</td>
<td style="text-align:right;">
19
</td>
<td style="text-align:right;">
43
</td>
<td style="text-align:left;">
259.3190
</td>
<td style="text-align:right;">
Control
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
Participant_593
</td>
<td style="text-align:right;">
Follow-up
</td>
<td style="text-align:right;">
2021-11-19
</td>
<td style="text-align:right;">
175d 0H 0M 0S
</td>
<td style="text-align:right;">
16
</td>
<td style="text-align:right;">
65
</td>
<td style="text-align:left;">
1290.4220
</td>
<td style="text-align:right;">
Control
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
Participant_20
</td>
<td style="text-align:right;">
Follow-up
</td>
<td style="text-align:right;">
2022-01-15
</td>
<td style="text-align:right;">
178d 0H 0M 0S
</td>
<td style="text-align:right;">
15
</td>
<td style="text-align:right;">
74
</td>
<td style="text-align:left;">
1787.4242
</td>
<td style="text-align:right;">
Intervention
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
Participant_259
</td>
<td style="text-align:right;">
Baseline
</td>
<td style="text-align:right;">
2021-09-15
</td>
<td style="text-align:right;">
0S
</td>
<td style="text-align:right;">
19
</td>
<td style="text-align:right;">
39
</td>
<td style="text-align:left;">
311.0018
</td>
<td style="text-align:right;">
Control
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:left;">
Participant_962
</td>
<td style="text-align:right;">
Baseline
</td>
<td style="text-align:right;">
2021-10-28
</td>
<td style="text-align:right;">
0S
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
45
</td>
<td style="text-align:left;">
276.2181
</td>
<td style="text-align:right;">
Intervention
</td>
<td style="text-align:right;">
2
</td>
</tr>
</tbody>
<tfoot><tr>
<td style="padding: 0; " colspan="100%">
<sup></sup>
</td>
</tr></tfoot>
</table>
<p>This dataset contains features that make it possible to use in conjunction with youthu’s economic analysis functions. These requirements are described in the vignette about <a href="Prediction_With_Mdls.html">finding and using models compatible models to predict QALYs</a>;</p>
<p>The dataset also contains a cost variable, which is a requirement for most, though not all, of the economic analyses that can be undertaken with youthu.</p>
</div>
<div class="section level2">
<h2 id="limitations-of-datasets-without-measures-of-health-utility">Limitations of datasets without measures of health utility<a class="anchor" aria-label="anchor" href="#limitations-of-datasets-without-measures-of-health-utility"></a>
</h2>
<p>A notable omission from the dataset is any measure of utility. This omission means that, in the absence of using mapping algorithms such as those included with youthu, the most feasible types of economic evaluation to apply to this dataset would likely be cost-consequence analysis (where a synopsis of the differences in a range of measures are presented alongside cost differences) and cost-effectiveness analysis (where a summary statistic - the incremental cost-effectiveness ratio or ICER - is calculated by dividing differences in costs by differences in a single outcome measure).</p>
<p>These types of economic analyses can be relatively simple to interpret if either the intervention or control arm is simultaneously cheaper and more effective across all included outcome measures. However, these conditions don’t hold in our sample data.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="op">(</span><span class="va">ds_tb</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">study_arm_chr</span> <span class="op">==</span> <span class="st">"Control"</span> <span class="op">&amp;</span> <span class="va">round</span> <span class="op">==</span> <span class="st">"Baseline"</span><span class="op">)</span><span class="op">)</span><span class="op">[</span><span class="fl">5</span><span class="op">:</span><span class="fl">6</span><span class="op">]</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">##       PHQ9          SOFAS      </span>
<span class="co">##  Min.   : 0.0   Min.   :39.00  </span>
<span class="co">##  1st Qu.: 7.0   1st Qu.:60.00  </span>
<span class="co">##  Median :12.0   Median :66.00  </span>
<span class="co">##  Mean   :10.9   Mean   :66.13  </span>
<span class="co">##  3rd Qu.:15.0   3rd Qu.:72.00  </span>
<span class="co">##  Max.   :19.0   Max.   :89.00</span></code></pre>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="op">(</span><span class="va">ds_tb</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">study_arm_chr</span> <span class="op">==</span> <span class="st">"Control"</span> <span class="op">&amp;</span> <span class="va">round</span> <span class="op">==</span> <span class="st">"Follow-up"</span><span class="op">)</span><span class="op">)</span><span class="op">[</span><span class="fl">5</span><span class="op">:</span><span class="fl">7</span><span class="op">]</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">##       PHQ9            SOFAS         costs_dbl     </span>
<span class="co">##  Min.   : 0.000   Min.   :39.00   Min.   : 889.9  </span>
<span class="co">##  1st Qu.: 4.000   1st Qu.:64.00   1st Qu.:1321.1  </span>
<span class="co">##  Median : 8.000   Median :71.00   Median :1486.7  </span>
<span class="co">##  Mean   : 8.493   Mean   :70.65   Mean   :1489.0  </span>
<span class="co">##  3rd Qu.:13.000   3rd Qu.:77.00   3rd Qu.:1627.0  </span>
<span class="co">##  Max.   :27.000   Max.   :98.00   Max.   :2216.5</span></code></pre>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="op">(</span><span class="va">ds_tb</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">study_arm_chr</span> <span class="op">==</span> <span class="st">"Intervention"</span> <span class="op">&amp;</span> <span class="va">round</span> <span class="op">==</span> <span class="st">"Baseline"</span><span class="op">)</span><span class="op">)</span><span class="op">[</span><span class="fl">5</span><span class="op">:</span><span class="fl">6</span><span class="op">]</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">##       PHQ9           SOFAS      </span>
<span class="co">##  Min.   : 0.00   Min.   :36.00  </span>
<span class="co">##  1st Qu.: 7.00   1st Qu.:61.00  </span>
<span class="co">##  Median :11.00   Median :67.00  </span>
<span class="co">##  Mean   :10.81   Mean   :66.74  </span>
<span class="co">##  3rd Qu.:15.00   3rd Qu.:72.25  </span>
<span class="co">##  Max.   :19.00   Max.   :88.00</span></code></pre>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="op">(</span><span class="va">ds_tb</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">study_arm_chr</span> <span class="op">==</span> <span class="st">"Intervention"</span> <span class="op">&amp;</span> <span class="va">round</span> <span class="op">==</span> <span class="st">"Follow-up"</span><span class="op">)</span><span class="op">)</span><span class="op">[</span><span class="fl">5</span><span class="op">:</span><span class="fl">7</span><span class="op">]</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">##       PHQ9            SOFAS      costs_dbl     </span>
<span class="co">##  Min.   : 0.000   Min.   :40   Min.   : 923.4  </span>
<span class="co">##  1st Qu.: 2.000   1st Qu.:60   1st Qu.:1625.6  </span>
<span class="co">##  Median : 6.500   Median :68   Median :1777.3  </span>
<span class="co">##  Mean   : 6.851   Mean   :68   Mean   :1807.8  </span>
<span class="co">##  3rd Qu.:11.000   3rd Qu.:77   3rd Qu.:1996.0  </span>
<span class="co">##  Max.   :25.000   Max.   :93   Max.   :2872.7</span></code></pre>
<p>The pattern of results summarised above create some significant barriers to meaningfully interpreting economic evaluations that are based on cost-consequence or cost-effectiveness analysis:</p>
<ul>
<li><p>A cost-effectiveness analysis in which change in PHQ-9 was the benefit measure would be difficult to interpret as the Intervention arm is both more effective and more costly, which begs the question is it worth paying the extra dollars for this improvement? Also - would a judgment of cost-effectiveness remain the same if the study had measured a slightly different incremental benefit or recorded change over a longer or shorter time horizon? It is likely that there is no commonly used value for money benchmark for improvements measured in PHQ-9, nor is there any time weighting associated with the measure. Furthermore, if the potential funding for the intervention is from a budget that is allocated to non-depressive illnesses (e.g. physical health), results from a cost-effectiveness analysis using PHQ-9 as its benefit measure are not readily comparable with economic evaluations of interventions from other illness groups using different benefit measures that are potentially competing for the same scarce funding.</p></li>
<li><p>A cost consequence analyses that summarised the differences in costs with the differences in changes in PHQ-9 and SOFAS score would be difficult to interpret because while the intervention is more effective than control for improvements measured on PHQ-9 (where lower scores are better), the control group is superior if benefits are based on functioning improvements as measured by SOFAS scores (where higher scores are better). The lack of any formal weighting for how to trade off clinical symptoms and functioning means that interpretation of this analysis will be highly subjective and likely to change across potential decision makers.</p></li>
</ul>
<p>These types of short-comings can be significantly addressed by undertaking cost-utility analyses (CUAs) as:</p>
<ul>
<li>they use a measure of benefit - the Quality Adjusted Life Year (QALY) - that captures multiple domains of health, weighted by time and population preferences in a single index measure that can be applied across health conditions;</li>
<li>there are published benchmark willingness to pay values for QALYs that are routinely used by decision makers in many countries to make ICER statistics readily interpretable in the context of health budget allocation.</li>
</ul>
<p>The rest of this article demonstrates how youthu functions can be used to undertake CUA based analyses on the type of data we have just profiled.</p>
</div>
<div class="section level2">
<h2 id="using-youthu-in-a-cost-utility-analysis-workflow">Using youthu in a cost-utility analysis workflow<a class="anchor" aria-label="anchor" href="#using-youthu-in-a-cost-utility-analysis-workflow"></a>
</h2>
<div class="section level3">
<h3 id="predict-adolescent-aqol-6d-health-utility">Predict adolescent AQoL-6D health utility<a class="anchor" aria-label="anchor" href="#predict-adolescent-aqol-6d-health-utility"></a>
</h3>
<p>Our first step is to identify which youthu models we will use to predict adolescent AQoL-6D and apply these models to our data. This step was explained in more detail in <a href="Prediction_With_Mdls.html">another vignette article about finding and using transfer to utility models</a>, so will be dealt with briefly here.</p>
<p>First we make sure that our dataset can be used as a prediction dataset in conjunction with the model we intend using.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">predn_ds_ls</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/make_predn_metadata_ls.html">make_predn_metadata_ls</a></span><span class="op">(</span><span class="va">ds_tb</span>,
                                      cmprsn_groups_chr <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Intervention"</span>, <span class="st">"Control"</span><span class="op">)</span>,
                                      cmprsn_var_nm_1L_chr <span class="op">=</span> <span class="st">"study_arm_chr"</span>,
                                      costs_var_nm_1L_chr <span class="op">=</span> <span class="st">"costs_dbl"</span>,
                                      id_var_nm_1L_chr <span class="op">=</span> <span class="st">"fkClientID"</span>,
                                      msrmnt_date_var_nm_1L_chr <span class="op">=</span> <span class="st">"date_psx"</span>,
                                      round_var_nm_1L_chr <span class="op">=</span> <span class="st">"round"</span>,
                                      round_bl_val_1L_chr <span class="op">=</span> <span class="st">"Baseline"</span>,
                                      utl_var_nm_1L_chr <span class="op">=</span> <span class="st">"AQoL6D_HU"</span>,
                                      mdls_lup <span class="op">=</span> <span class="fu"><a href="../reference/get_mdls_lup.html">get_mdls_lup</a></span><span class="op">(</span>utility_type_chr <span class="op">=</span> <span class="st">"AQoL-6D"</span>,
                                                              mdl_predrs_in_ds_chr <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"PHQ9 total score"</span>,
                                                                                       <span class="st">"SOFAS total score"</span><span class="op">)</span>,
                                                              ttu_dv_nms_chr <span class="op">=</span> <span class="st">"TTU"</span><span class="op">)</span>,
                                      mdl_nm_1L_chr <span class="op">=</span>  <span class="st">"PHQ9_SOFAS_1_OLS_CLL"</span><span class="op">)</span></code></pre></div>
<p>We now use our preferred model to predict health utility from the measures in our dataset.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ds_tb</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/add_utl_predn.html">add_utl_predn</a></span><span class="op">(</span><span class="va">ds_tb</span>,
                       predn_ds_ls <span class="op">=</span> <span class="va">predn_ds_ls</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">fkClientID</span>, <span class="va">round</span>, <span class="va">study_arm_chr</span>, <span class="va">date_psx</span>, <span class="va">duration_prd</span>, <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html" class="external-link">everything</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Joining, by = c("fkClientID", "round")</span></code></pre>
</div>
<div class="section level3">
<h3 id="calculate-qalys">Calculate QALYs<a class="anchor" aria-label="anchor" href="#calculate-qalys"></a>
</h3>
<p>Next we combine the health utility data with the interval between measurement data to calculate QALYs and add them to the dataset.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ds_tb</span>  <span class="op">&lt;-</span> <span class="va">ds_tb</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="../reference/add_qalys_to_ds.html">add_qalys_to_ds</a></span><span class="op">(</span>predn_ds_ls <span class="op">=</span> <span class="va">predn_ds_ls</span>,
                                    include_predrs_1L_lgl <span class="op">=</span> <span class="cn">T</span>,
                                    reshape_1L_lgl <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></code></pre></div>
<table class="table  lightable-paper lightable-hover" style='font-family: "Arial Narrow", arial, helvetica, sans-serif; width: auto !important; margin-left: auto; margin-right: auto;border-bottom: 0;'>
<caption>
First few records from updated dataset with QALYs
</caption>
<thead><tr>
<th style="text-align:left;">
fkClientID
</th>
<th style="text-align:right;">
study_arm_chr
</th>
<th style="text-align:right;">
match_idx_int
</th>
<th style="text-align:right;">
date_psx_Baseline
</th>
<th style="text-align:right;">
date_psx_Follow-up
</th>
<th style="text-align:right;">
duration_prd_Baseline
</th>
<th style="text-align:left;">
duration_prd_Follow-up
</th>
<th style="text-align:right;">
costs_dbl_Baseline
</th>
<th style="text-align:right;">
costs_dbl_Follow-up
</th>
<th style="text-align:right;">
PHQ9_Baseline
</th>
<th style="text-align:right;">
PHQ9_Follow-up
</th>
<th style="text-align:right;">
SOFAS_Baseline
</th>
<th style="text-align:left;">
SOFAS_Follow-up
</th>
<th style="text-align:right;">
AQoL6D_HU_Baseline
</th>
<th style="text-align:right;">
AQoL6D_HU_Follow-up
</th>
<th style="text-align:right;">
PHQ9_change_dbl_Baseline
</th>
<th style="text-align:right;">
PHQ9_change_dbl_Follow-up
</th>
<th style="text-align:right;">
SOFAS_change_dbl_Baseline
</th>
<th style="text-align:left;">
SOFAS_change_dbl_Follow-up
</th>
<th style="text-align:right;">
AQoL6D_HU_change_dbl_Baseline
</th>
<th style="text-align:right;">
AQoL6D_HU_change_dbl_Follow-up
</th>
<th style="text-align:right;">
qalys_dbl_Baseline
</th>
<th style="text-align:right;">
qalys_dbl_Follow-up
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
Participant_10
</td>
<td style="text-align:right;">
Control
</td>
<td style="text-align:right;">
243
</td>
<td style="text-align:right;">
2021-05-06
</td>
<td style="text-align:right;">
2021-10-30
</td>
<td style="text-align:right;">
0S
</td>
<td style="text-align:left;">
177d 0H 0M 0S
</td>
<td style="text-align:right;">
647.9386
</td>
<td style="text-align:right;">
1696.235
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
61
</td>
<td style="text-align:left;">
64
</td>
<td style="text-align:right;">
0.7600161
</td>
<td style="text-align:right;">
0.6065245
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
3
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
-0.1534916
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.3311125
</td>
</tr>
<tr>
<td style="text-align:left;">
Participant_1000
</td>
<td style="text-align:right;">
Control
</td>
<td style="text-align:right;">
191
</td>
<td style="text-align:right;">
2021-07-02
</td>
<td style="text-align:right;">
2022-01-02
</td>
<td style="text-align:right;">
0S
</td>
<td style="text-align:left;">
184d 0H 0M 0S
</td>
<td style="text-align:right;">
428.9205
</td>
<td style="text-align:right;">
1619.037
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
63
</td>
<td style="text-align:left;">
82
</td>
<td style="text-align:right;">
0.8451426
</td>
<td style="text-align:right;">
0.7679962
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
-2
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
19
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
-0.0771464
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.4063211
</td>
</tr>
<tr>
<td style="text-align:left;">
Participant_1001
</td>
<td style="text-align:right;">
Intervention
</td>
<td style="text-align:right;">
230
</td>
<td style="text-align:right;">
2021-05-27
</td>
<td style="text-align:right;">
2021-11-22
</td>
<td style="text-align:right;">
0S
</td>
<td style="text-align:left;">
179d 0H 0M 0S
</td>
<td style="text-align:right;">
429.3703
</td>
<td style="text-align:right;">
1844.219
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
14
</td>
<td style="text-align:right;">
59
</td>
<td style="text-align:left;">
72
</td>
<td style="text-align:right;">
0.6116001
</td>
<td style="text-align:right;">
0.8609119
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
13
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.2493118
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.3608209
</td>
</tr>
<tr>
<td style="text-align:left;">
Participant_1003
</td>
<td style="text-align:right;">
Intervention
</td>
<td style="text-align:right;">
115
</td>
<td style="text-align:right;">
2021-06-25
</td>
<td style="text-align:right;">
2021-12-24
</td>
<td style="text-align:right;">
0S
</td>
<td style="text-align:left;">
182d 0H 0M 0S
</td>
<td style="text-align:right;">
395.1637
</td>
<td style="text-align:right;">
1537.365
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
71
</td>
<td style="text-align:left;">
81
</td>
<td style="text-align:right;">
0.5788130
</td>
<td style="text-align:right;">
0.9316209
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
-9
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
10
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.3528079
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.3763162
</td>
</tr>
<tr>
<td style="text-align:left;">
Participant_1005
</td>
<td style="text-align:right;">
Intervention
</td>
<td style="text-align:right;">
183
</td>
<td style="text-align:right;">
2021-09-26
</td>
<td style="text-align:right;">
2022-03-31
</td>
<td style="text-align:right;">
0S
</td>
<td style="text-align:left;">
186d 0H 0M 0S
</td>
<td style="text-align:right;">
402.9910
</td>
<td style="text-align:right;">
1826.511
</td>
<td style="text-align:right;">
17
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
78
</td>
<td style="text-align:left;">
88
</td>
<td style="text-align:right;">
0.5479434
</td>
<td style="text-align:right;">
0.9593007
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
-17
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
10
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.4113573
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.3837747
</td>
</tr>
<tr>
<td style="text-align:left;">
Participant_1006
</td>
<td style="text-align:right;">
Intervention
</td>
<td style="text-align:right;">
219
</td>
<td style="text-align:right;">
2021-10-22
</td>
<td style="text-align:right;">
2022-04-19
</td>
<td style="text-align:right;">
0S
</td>
<td style="text-align:left;">
179d 0H 0M 0S
</td>
<td style="text-align:right;">
534.2285
</td>
<td style="text-align:right;">
2401.478
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
14
</td>
<td style="text-align:right;">
75
</td>
<td style="text-align:left;">
73
</td>
<td style="text-align:right;">
0.7241764
</td>
<td style="text-align:right;">
0.5884387
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
-2
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
-0.1357377
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.3216401
</td>
</tr>
</tbody>
<tfoot><tr>
<td style="padding: 0; " colspan="100%">
<sup></sup>
</td>
</tr></tfoot>
</table>
</div>
<div class="section level3">
<h3 id="analyse-results">Analyse results<a class="anchor" aria-label="anchor" href="#analyse-results"></a>
</h3>
<p>Now we can run the main economic analysis. This is implemented by the <code class="sourceCode r">make_hlth_ec_smry</code> function, which first bootstraps the dataset (implemented by the <code>boot</code> function from the <code>boot</code> package) before passing the mean values for costs and QALYs from each bootstrap sample to with <code>bcea</code> function of the <code>BCEA</code> package to calculate a range of health economic statistics. For this example we pass a value of 50,000 for the willingness to pay parameter, as this is the dollar amount commonly used in Australia as a benchmark for the value of a QALY.</p>
<p>Note, for this illustrative example we only request 1000 bootstrap iterations - in practice this number may be higher.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">he_smry_ls</span> <span class="op">&lt;-</span> <span class="va">ds_tb</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="../reference/make_hlth_ec_smry.html">make_hlth_ec_smry</a></span><span class="op">(</span>predn_ds_ls <span class="op">=</span> <span class="va">predn_ds_ls</span>,
                                                 wtp_dbl <span class="op">=</span> <span class="fl">50000</span>,
                                                 bootstrap_iters_1L_int <span class="op">=</span> <span class="fl">1000L</span><span class="op">)</span></code></pre></div>
<p>As part of the output of the <code class="sourceCode r">make_hlth_ec_smry</code> function is a BCEA object, we can use the BCEA package to produce a number of graphical summaries of economic results. One of the most important is the production of a cost-effectiveness plane. This plot highlights that, with an ICER of $-99,800.86, less than half of the bootstrapped iteration incremental cost and QALY pairs fall within the zone of cost-effectiveness (green). In fact, at the cost-effectiveness threshold we supplied, the results suggest there is a 8.2% probability that the intervention is cost-effective.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span>
<span class="fu">BCEA</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BCEA/man/ceplane.plot.html" class="external-link">ceplane.plot</a></span><span class="op">(</span><span class="va">he_smry_ls</span><span class="op">$</span><span class="va">ce_res_ls</span>, wtp <span class="op">=</span><span class="fl">50000</span>,    
                   area_color <span class="op">=</span> <span class="st">"green"</span>,
                    graph <span class="op">=</span> <span class="st">"ggplot2"</span>,
          theme <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_light</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Warning: Duplicated aesthetics after name standardisation: colour</span></code></pre>
<p><img src="Economic_Analysis_files/figure-html/unnamed-chunk-13-1.png" width="576"></p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Matthew Hamilton, Caroline Gao, Orygen, Headspace, National Health and Medical Research Council.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
